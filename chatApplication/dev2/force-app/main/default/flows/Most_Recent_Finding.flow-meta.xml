<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <assignments>
        <name>Findings_Count</name>
        <label>Findings Count</label>
        <locationX>593</locationX>
        <locationY>405</locationY>
        <assignmentItems>
            <assignToReference>FindingsCount</assignToReference>
            <operator>Add</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Over_Findings</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>WorkCount</name>
        <label>WorkCount</label>
        <locationX>305</locationX>
        <locationY>742</locationY>
        <assignmentItems>
            <assignToReference>FutureWorkCount</assignToReference>
            <operator>Add</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Over_Future_Work</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Last_Two_Findings</name>
        <label>Last Two Findings</label>
        <locationX>358</locationX>
        <locationY>229</locationY>
        <defaultConnectorLabel>[Default Outcome]</defaultConnectorLabel>
        <rules>
            <name>First</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>FindingsCount</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>1.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Case_to_Update1</targetReference>
            </connector>
            <label>First</label>
        </rules>
        <rules>
            <name>Two</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>FindingsCount</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>2.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Case_to_Update2</targetReference>
            </connector>
            <label>Two</label>
        </rules>
    </decisions>
    <decisions>
        <name>Last_Two_Future_Works</name>
        <label>Last Two Future Works</label>
        <locationX>341</locationX>
        <locationY>474</locationY>
        <defaultConnectorLabel>[Default Outcome]</defaultConnectorLabel>
        <rules>
            <name>FirstWork</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>FutureWorkCount</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>1.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Case_Update_Other_Work</targetReference>
            </connector>
            <label>FirstWork</label>
        </rules>
        <rules>
            <name>TwoWork</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>FutureWorkCount</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>2.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Case_Update_Other_Work_2</targetReference>
            </connector>
            <label>TwoWork</label>
        </rules>
    </decisions>
    <description>Flow launces from process builder &apos;Case - Most Recent Findings&apos; and searches for the most recent finding related to the associated serial number on the case. Populates the &apos;Most Recent Findings&apos; field on the case.</description>
    <interviewLabel>Case - Find and Populate Most Finding {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Case - Find and Populate Recent FindingsTEST</label>
    <loops>
        <name>Loop_Over_Findings</name>
        <label>Loop Over Findings</label>
        <locationX>112</locationX>
        <locationY>225</locationY>
        <assignNextValueToReference>Find</assignNextValueToReference>
        <collectionReference>FindingsList</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Last_Two_Findings</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>AllFutureWorkList</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_Over_Future_Work</name>
        <label>Loop Over Future Work</label>
        <locationX>111</locationX>
        <locationY>531</locationY>
        <assignNextValueToReference>FutureWork</assignNextValueToReference>
        <collectionReference>FutureWorkList</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Last_Two_Future_Works</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>AllFindingsList</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <name>AllFindingsList</name>
        <label>AllFindingsList</label>
        <locationX>10</locationX>
        <locationY>116</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Loop_Over_Findings</targetReference>
        </connector>
        <filters>
            <field>Serial_Number__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>SerialNumberID</elementReference>
            </value>
        </filters>
        <object>Finding__c</object>
        <outputReference>FindingsList</outputReference>
        <queriedFields>Finding_Detail__c</queriedFields>
        <queriedFields>CreatedDate</queriedFields>
        <sortField>CreatedDate</sortField>
        <sortOrder>Desc</sortOrder>
    </recordLookups>
    <recordLookups>
        <name>AllFutureWorkList</name>
        <label>AllFutureWorkList</label>
        <locationX>134</locationX>
        <locationY>363</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Loop_Over_Future_Work</targetReference>
        </connector>
        <filters>
            <field>Serial_Number__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>SerialNumberID</elementReference>
            </value>
        </filters>
        <object>Other_Work_Required__c</object>
        <outputReference>FutureWorkList</outputReference>
        <queriedFields>Required_Work__c</queriedFields>
        <queriedFields>CreatedDate</queriedFields>
        <sortField>CreatedDate</sortField>
        <sortOrder>Desc</sortOrder>
    </recordLookups>
    <recordLookups>
        <name>Lookup_Serial_Number</name>
        <label>Lookup Serial Number</label>
        <locationX>10</locationX>
        <locationY>7</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>AllFutureWorkList</targetReference>
        </connector>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>SerialNumberID</elementReference>
            </value>
        </filters>
        <object>Asset</object>
        <outputAssignments>
            <assignToReference>SpecialModification</assignToReference>
            <field>Special_Modifications__c</field>
        </outputAssignments>
    </recordLookups>
    <recordUpdates>
        <name>Case_to_Update1</name>
        <label>Case to Update1</label>
        <locationX>595</locationX>
        <locationY>162</locationY>
        <connector>
            <targetReference>Findings_Count</targetReference>
        </connector>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>RelatedCase</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Most_Recent_Finding__c</field>
            <value>
                <elementReference>Find.Finding_Detail__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Special_Modifications__c</field>
            <value>
                <elementReference>SpecialModification</elementReference>
            </value>
        </inputAssignments>
        <object>Case</object>
    </recordUpdates>
    <recordUpdates>
        <name>Case_to_Update2</name>
        <label>Case to Update2</label>
        <locationX>739</locationX>
        <locationY>262</locationY>
        <connector>
            <targetReference>Findings_Count</targetReference>
        </connector>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>RelatedCase</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Second_Most_Recent_Finding__c</field>
            <value>
                <elementReference>Find.Finding_Detail__c</elementReference>
            </value>
        </inputAssignments>
        <object>Case</object>
    </recordUpdates>
    <recordUpdates>
        <name>Case_Update_Other_Work</name>
        <label>Case Update Other Work</label>
        <locationX>575</locationX>
        <locationY>511</locationY>
        <connector>
            <targetReference>WorkCount</targetReference>
        </connector>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>RelatedCase</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Other_Work_Required__c</field>
            <value>
                <elementReference>FutureWork.Required_Work__c</elementReference>
            </value>
        </inputAssignments>
        <object>Case</object>
    </recordUpdates>
    <recordUpdates>
        <name>Case_Update_Other_Work_2</name>
        <label>Case Update Other Work 2</label>
        <locationX>595</locationX>
        <locationY>631</locationY>
        <connector>
            <targetReference>WorkCount</targetReference>
        </connector>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>RelatedCase</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Other_Work_Required_2__c</field>
            <value>
                <elementReference>FutureWork.Required_Work__c</elementReference>
            </value>
        </inputAssignments>
        <object>Case</object>
    </recordUpdates>
    <startElementReference>Lookup_Serial_Number</startElementReference>
    <status>Active</status>
    <variables>
        <name>AllFindings</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>Find</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Finding__c</objectType>
    </variables>
    <variables>
        <name>FindingsCount</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>1</scale>
        <value>
            <numberValue>1.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>FindingsDetail</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>FindingsList</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Finding__c</objectType>
    </variables>
    <variables>
        <name>FutureWork</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Other_Work_Required__c</objectType>
    </variables>
    <variables>
        <name>FutureWorkCount</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>1</scale>
        <value>
            <numberValue>1.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>FutureWorkList</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Other_Work_Required__c</objectType>
    </variables>
    <variables>
        <name>RelatedCase</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>SerialNumberID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>SpecialModification</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
