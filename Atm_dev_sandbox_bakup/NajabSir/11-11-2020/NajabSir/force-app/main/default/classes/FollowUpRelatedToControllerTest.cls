@isTest
public class FollowUpRelatedToControllerTest {
    @testSetup
    static void insertRecords(){
         //For Code Creation
        List<For_Code__c> forCodeList = TestDataFactory.createTestForCode(1);
        insert forCodeList;
        //Accounts Creation
        List<Account> accList = TestDataFactory.createBusinessAccount(1, 'Dealer');
        accList[0].For_Code__c = forCodeList[0].Id;
        accList[0].MOS_Category__c = 'MOS';
        accList[0].Stakeholder_Hierarchy__c = '{ "trueValue": null, "serviceNexa": [{ "stakeHolder": "L8C", "refName": "DDVM - STLSD", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L1A", "refName": "WM", "recordId": "", "phone": "1234567890", "email": "" }, { "stakeHolder": "L2A", "refName": "GM", "recordId": "", "phone": "8439024407", "email": "" }, { "stakeHolder": "L6D", "refName": "Nexa Service", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L10", "refName": "EO Service", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L8B", "refName": "CH", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L3A", "refName": "Nexa Service TSM", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L6A", "refName": "TCR Co-ordinator", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L3B", "refName": "Nexa Service Complaint ROC", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L8E", "refName": "DDVM - ASTW", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L7A", "refName": "DPM TCR", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L9", "refName": "Div Head", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "MOSROC", "refName": "Nexa MOS ROC", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L5", "refName": "ZSH", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L8D", "refName": "DVM - SNSDM", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L6C", "refName": "Nexa Service", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L6B", "refName": "AGM TCR", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L4", "refName": "RSM", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L8A", "refName": "CH", "recordId": "", "phone": "", "email": "" } ], "serviceArena": [{ "stakeHolder": "L6C", "refName": "L6C Arena Service", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L8D", "refName": "DVM - SNSDM", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L8E", "refName": "DDVM - ASTW", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L6D", "refName": "Arena Service", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L4", "refName": "RSM", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L8A", "refName": "CH", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L3B", "refName": "Arena Service Complaint ROC", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L3A", "refName": "Director", "recordId": "0051s000000eFn4AAE", "phone": "", "email": "pkini@salesforce.com" }, { "stakeHolder": "L8B", "refName": "CH", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L5", "refName": "ZSH", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "MOSROC", "refName": "Arena MOS ROC", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L9", "refName": "Div Head", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L7A", "refName": "DPM TCR", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L8C", "refName": "DDVM - STLSD", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L6B", "refName": "AGM TCR", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L10", "refName": "EO Service", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L6A", "refName": "TCR Co-ordinator", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L1A", "refName": "WM", "recordId": "", "phone": "1234567890", "email": "" }, { "stakeHolder": "L2A", "refName": "GM", "recordId": "", "phone": "8439024407", "email": "" } ], "service": null, "sales": [{ "stakeHolder": "L9", "refName": "Div Head", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L10", "refName": "EO", "recordId": "0057F000006zcf1QAA", "phone": "", "email": "prabhat@techmatrixconsulting.com" }, { "stakeHolder": "L3A", "refName": "Arena TSM C1", "recordId": "0057F000006zcesQAA", "phone": "9898989898", "email": "gitika.k@techmatrixconsulting.com" }, { "stakeHolder": "L5", "refName": "Arena_CBH_C", "recordId": "0057F000006zcelQAA", "phone": "9789788989", "email": "smonteiro@salesforce.com" }, { "stakeHolder": "L8A", "refName": "Arena_DVM", "recordId": "0057F000006zcf0QAA", "phone": "", "email": "deepak.kumar@techmatrixconsulting.com" }, { "stakeHolder": "L7A", "refName": "SNP AC Coordinator", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L4", "refName": "Arena_RM_C1", "recordId": "0057F000006zcemQAA", "phone": "", "email": "prabhat@techmatrixconsulting.com" }, { "stakeHolder": "L6A", "refName": "SNP AC Coordinator", "recordId": "", "phone": "", "email": "" }], "msilQuery": null, "msgp": null, "msds": null, "loyaltyProgram": [{ "stakeHolder": "NM-LPD", "refName": "NM-LPD", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "DH-LPD", "refName": "DH-LPD", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "DVH-MKT3", "refName": "DVH-MKT3", "recordId": "", "phone": "", "email": "" }], "finance": null, "accessories": [{ "stakeHolder": "L10", "refName": "EO", "recordId": "0057F000006zcf1QAA", "phone": "", "email": "prabhat@techmatrixconsulting.com" }, { "stakeHolder": "L6A", "refName": "SNP AC Coordinator", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L3A", "refName": "MGA RAM C1", "recordId": "0057F000006zcf8QAA", "phone": "", "email": "akhil.jain@maruti.co.in.invalid" }, { "stakeHolder": "L9", "refName": "Div Head", "recordId": "", "phone": "", "email": "" }, { "stakeHolder": "L8A", "refName": "Arena_CBH_C", "recordId": "0057F000006zcelQAA", "phone": "9789788989", "email": "smonteiro@salesforce.com" }] } ';
        insert accList;
        Implementation_Strategy__c impObj = TestDataFactory.createImplementation('CaseComplaintTriggerServiceImpl','Complaint');
        insert impObj;
        Id complaintRecordTypeId = Schema.SObjectType.Case.getRecordTypeInfosByName().get('Complaint').getRecordTypeId();
        list<case> caseList = TestDataFactory.createCase(1,complaintRecordTypeId);
        caseList[0].Allocated_Dealer__c = accList[0].Id;
        caseList[0].OwnerId = userInfo.getUserId();
        caseList[0].Channel__c = 'Arena';
        insert caseList;  
    }
    @isTest
    static void testMethd(){
        list<case> caseList = [Select Id,Case_Type__c,MOS_Case_Stage__c,OwnerId,Allocated_Dealer__r.Stakeholder_Hierarchy__c from case];
        Custom_Activity__c task = new Custom_Activity__c();
        map<string,object> stakeHolderPhoneMap = new map<string,object>{'stakeHolder'=>'L1A'};
            map<String,string> mapCallOriginToPhone = new map<String,string>();
        FollowUpRelatedToController.getAllDetails(caseList[0].Id);
        FollowUpRelatedToController.saveFollowUp(task, caseList[0]);
        
        caseList[0].OwnerId = userInfo.getUserId();
        update caseList;
        FollowUpRelatedToController.getAllDetails(caseList[0].Id);
        FollowUpRelatedToController.saveFollowUp(task, caseList[0]);
        
    }
}